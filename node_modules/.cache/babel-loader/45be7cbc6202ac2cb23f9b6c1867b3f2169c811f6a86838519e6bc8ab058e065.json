{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { defineComponent, inject, computed, onMounted, watch, onBeforeUnmount, openBlock, createBlock, unref, mergeProps, withCtx, renderSlot, createCommentVNode } from 'vue';\nimport { isNil } from 'lodash-unified';\nimport { unrefElement } from '@vueuse/core';\nimport '../../slot/index.mjs';\nimport '../../../hooks/index.mjs';\nimport '../../../utils/index.mjs';\nimport { POPPER_INJECTION_KEY } from './constants.mjs';\nimport { popperTriggerProps } from './trigger.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useForwardRef } from '../../../hooks/use-forward-ref/index.mjs';\nimport { isElement } from '../../../utils/types.mjs';\nimport { OnlyChild } from '../../slot/src/only-child.mjs';\nvar __default__ = defineComponent({\n  name: \"ElPopperTrigger\",\n  inheritAttrs: false\n});\nvar _sfc_main = /* @__PURE__ */defineComponent(_objectSpread(_objectSpread({}, __default__), {}, {\n  props: popperTriggerProps,\n  setup: function setup(__props, _ref) {\n    var expose = _ref.expose;\n    var props = __props;\n    var _inject = inject(POPPER_INJECTION_KEY, void 0),\n      role = _inject.role,\n      triggerRef = _inject.triggerRef;\n    useForwardRef(triggerRef);\n    var ariaControls = computed(function () {\n      return ariaHaspopup.value ? props.id : void 0;\n    });\n    var ariaDescribedby = computed(function () {\n      if (role && role.value === \"tooltip\") {\n        return props.open && props.id ? props.id : void 0;\n      }\n      return void 0;\n    });\n    var ariaHaspopup = computed(function () {\n      if (role && role.value !== \"tooltip\") {\n        return role.value;\n      }\n      return void 0;\n    });\n    var ariaExpanded = computed(function () {\n      return ariaHaspopup.value ? \"\".concat(props.open) : void 0;\n    });\n    var virtualTriggerAriaStopWatch = void 0;\n    onMounted(function () {\n      watch(function () {\n        return props.virtualRef;\n      }, function (virtualEl) {\n        if (virtualEl) {\n          triggerRef.value = unrefElement(virtualEl);\n        }\n      }, {\n        immediate: true\n      });\n      watch(triggerRef, function (el, prevEl) {\n        virtualTriggerAriaStopWatch == null ? void 0 : virtualTriggerAriaStopWatch();\n        virtualTriggerAriaStopWatch = void 0;\n        if (isElement(el)) {\n          ;\n          [\"onMouseenter\", \"onMouseleave\", \"onClick\", \"onKeydown\", \"onFocus\", \"onBlur\", \"onContextmenu\"].forEach(function (eventName) {\n            var _a;\n            var handler = props[eventName];\n            if (handler) {\n              ;\n              el.addEventListener(eventName.slice(2).toLowerCase(), handler);\n              (_a = prevEl == null ? void 0 : prevEl.removeEventListener) == null ? void 0 : _a.call(prevEl, eventName.slice(2).toLowerCase(), handler);\n            }\n          });\n          virtualTriggerAriaStopWatch = watch([ariaControls, ariaDescribedby, ariaHaspopup, ariaExpanded], function (watches) {\n            ;\n            [\"aria-controls\", \"aria-describedby\", \"aria-haspopup\", \"aria-expanded\"].forEach(function (key, idx) {\n              isNil(watches[idx]) ? el.removeAttribute(key) : el.setAttribute(key, watches[idx]);\n            });\n          }, {\n            immediate: true\n          });\n        }\n        if (isElement(prevEl)) {\n          ;\n          [\"aria-controls\", \"aria-describedby\", \"aria-haspopup\", \"aria-expanded\"].forEach(function (key) {\n            return prevEl.removeAttribute(key);\n          });\n        }\n      }, {\n        immediate: true\n      });\n    });\n    onBeforeUnmount(function () {\n      virtualTriggerAriaStopWatch == null ? void 0 : virtualTriggerAriaStopWatch();\n      virtualTriggerAriaStopWatch = void 0;\n    });\n    expose({\n      triggerRef: triggerRef\n    });\n    return function (_ctx, _cache) {\n      return !_ctx.virtualTriggering ? (openBlock(), createBlock(unref(OnlyChild), mergeProps({\n        key: 0\n      }, _ctx.$attrs, {\n        \"aria-controls\": unref(ariaControls),\n        \"aria-describedby\": unref(ariaDescribedby),\n        \"aria-expanded\": unref(ariaExpanded),\n        \"aria-haspopup\": unref(ariaHaspopup)\n      }), {\n        \"default\": withCtx(function () {\n          return [renderSlot(_ctx.$slots, \"default\")];\n        }),\n        _: 3\n      }, 16, [\"aria-controls\", \"aria-describedby\", \"aria-expanded\", \"aria-haspopup\"])) : createCommentVNode(\"v-if\", true);\n    };\n  }\n}));\nvar ElPopperTrigger = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue\"]]);\nexport { ElPopperTrigger as default };","map":{"version":3,"names":["name","inheritAttrs","_inject","inject","POPPER_INJECTION_KEY","role","triggerRef","useForwardRef","ariaControls","computed","ariaHaspopup","value","props","id","ariaDescribedby","open","ariaExpanded","concat","virtualTriggerAriaStopWatch","onMounted","watch","virtualRef","virtualEl","unrefElement","immediate","el","prevEl","isElement","forEach","eventName","_a","handler","addEventListener","slice","toLowerCase","removeEventListener","call","watches","key","idx","isNil","removeAttribute","setAttribute","onBeforeUnmount","expose"],"sources":["../../../../../../packages/components/popper/src/trigger.vue"],"sourcesContent":["<template>\n  <el-only-child\n    v-if=\"!virtualTriggering\"\n    v-bind=\"$attrs\"\n    :aria-controls=\"ariaControls\"\n    :aria-describedby=\"ariaDescribedby\"\n    :aria-expanded=\"ariaExpanded\"\n    :aria-haspopup=\"ariaHaspopup\"\n  >\n    <slot />\n  </el-only-child>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, inject, onBeforeUnmount, onMounted, watch } from 'vue'\nimport { isNil } from 'lodash-unified'\nimport { unrefElement } from '@vueuse/core'\nimport { ElOnlyChild } from '@element-plus/components/slot'\nimport { useForwardRef } from '@element-plus/hooks'\nimport { isElement } from '@element-plus/utils'\nimport { POPPER_INJECTION_KEY } from './constants'\nimport { popperTriggerProps } from './trigger'\n\nimport type { WatchStopHandle } from 'vue'\n\ndefineOptions({\n  name: 'ElPopperTrigger',\n  inheritAttrs: false,\n})\n\nconst props = defineProps(popperTriggerProps)\n\nconst { role, triggerRef } = inject(POPPER_INJECTION_KEY, undefined)!\n\nuseForwardRef(triggerRef)\n\nconst ariaControls = computed<string | undefined>(() => {\n  return ariaHaspopup.value ? props.id : undefined\n})\n\nconst ariaDescribedby = computed<string | undefined>(() => {\n  if (role && role.value === 'tooltip') {\n    return props.open && props.id ? props.id : undefined\n  }\n  return undefined\n})\n\nconst ariaHaspopup = computed<string | undefined>(() => {\n  if (role && role.value !== 'tooltip') {\n    return role.value\n  }\n  return undefined\n})\n\nconst ariaExpanded = computed<string | undefined>(() => {\n  return ariaHaspopup.value ? `${props.open}` : undefined\n})\n\nlet virtualTriggerAriaStopWatch: WatchStopHandle | undefined = undefined\n\nonMounted(() => {\n  watch(\n    () => props.virtualRef,\n    (virtualEl) => {\n      if (virtualEl) {\n        triggerRef.value = unrefElement(virtualEl as HTMLElement)\n      }\n    },\n    {\n      immediate: true,\n    }\n  )\n\n  watch(\n    triggerRef,\n    (el, prevEl) => {\n      virtualTriggerAriaStopWatch?.()\n      virtualTriggerAriaStopWatch = undefined\n      if (isElement(el)) {\n        ;(\n          [\n            'onMouseenter',\n            'onMouseleave',\n            'onClick',\n            'onKeydown',\n            'onFocus',\n            'onBlur',\n            'onContextmenu',\n          ] as const\n        ).forEach((eventName) => {\n          const handler = props[eventName]\n          if (handler) {\n            ;(el as HTMLElement).addEventListener(\n              eventName.slice(2).toLowerCase(),\n              handler\n            )\n            ;(prevEl as HTMLElement)?.removeEventListener?.(\n              eventName.slice(2).toLowerCase(),\n              handler\n            )\n          }\n        })\n        virtualTriggerAriaStopWatch = watch(\n          [ariaControls, ariaDescribedby, ariaHaspopup, ariaExpanded],\n          (watches) => {\n            ;[\n              'aria-controls',\n              'aria-describedby',\n              'aria-haspopup',\n              'aria-expanded',\n            ].forEach((key, idx) => {\n              isNil(watches[idx])\n                ? el.removeAttribute(key)\n                : el.setAttribute(key, watches[idx]!)\n            })\n          },\n          { immediate: true }\n        )\n      }\n      if (isElement(prevEl)) {\n        ;[\n          'aria-controls',\n          'aria-describedby',\n          'aria-haspopup',\n          'aria-expanded',\n        ].forEach((key) => prevEl.removeAttribute(key))\n      }\n    },\n    {\n      immediate: true,\n    }\n  )\n})\n\nonBeforeUnmount(() => {\n  virtualTriggerAriaStopWatch?.()\n  virtualTriggerAriaStopWatch = undefined\n})\n\ndefineExpose({\n  /**\n   * @description trigger element\n   */\n  triggerRef,\n})\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}