{"ast":null,"code":"function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i[\"return\"] && (_r = _i[\"return\"](), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nimport { inject, ref, computed, onMounted, watch, toRef, onUnmounted } from 'vue';\nimport '../../../../hooks/index.mjs';\nimport { formContextKey, formItemContextKey } from '../constants.mjs';\nimport { useId } from '../../../../hooks/use-id/index.mjs';\nvar useFormItem = function useFormItem() {\n  var form = inject(formContextKey, void 0);\n  var formItem = inject(formItemContextKey, void 0);\n  return {\n    form: form,\n    formItem: formItem\n  };\n};\nvar useFormItemInputId = function useFormItemInputId(props, _ref) {\n  var formItemContext = _ref.formItemContext,\n    disableIdGeneration = _ref.disableIdGeneration,\n    disableIdManagement = _ref.disableIdManagement;\n  if (!disableIdGeneration) {\n    disableIdGeneration = ref(false);\n  }\n  if (!disableIdManagement) {\n    disableIdManagement = ref(false);\n  }\n  var inputId = ref();\n  var idUnwatch = void 0;\n  var isLabeledByFormItem = computed(function () {\n    var _a;\n    return !!(!props.label && formItemContext && formItemContext.inputIds && ((_a = formItemContext.inputIds) == null ? void 0 : _a.length) <= 1);\n  });\n  onMounted(function () {\n    idUnwatch = watch([toRef(props, \"id\"), disableIdGeneration], function (_ref2) {\n      var _ref3 = _slicedToArray(_ref2, 2),\n        id = _ref3[0],\n        disableIdGeneration2 = _ref3[1];\n      var newId = id != null ? id : !disableIdGeneration2 ? useId().value : void 0;\n      if (newId !== inputId.value) {\n        if (formItemContext == null ? void 0 : formItemContext.removeInputId) {\n          inputId.value && formItemContext.removeInputId(inputId.value);\n          if (!(disableIdManagement == null ? void 0 : disableIdManagement.value) && !disableIdGeneration2 && newId) {\n            formItemContext.addInputId(newId);\n          }\n        }\n        inputId.value = newId;\n      }\n    }, {\n      immediate: true\n    });\n  });\n  onUnmounted(function () {\n    idUnwatch && idUnwatch();\n    if (formItemContext == null ? void 0 : formItemContext.removeInputId) {\n      inputId.value && formItemContext.removeInputId(inputId.value);\n    }\n  });\n  return {\n    isLabeledByFormItem: isLabeledByFormItem,\n    inputId: inputId\n  };\n};\nexport { useFormItem, useFormItemInputId };","map":{"version":3,"names":["useFormItem","form","inject","formContextKey","formItem","formItemContextKey","useFormItemInputId","props","_ref","formItemContext","disableIdGeneration","disableIdManagement","ref","inputId","idUnwatch","isLabeledByFormItem","computed","_a","label","inputIds","length","onMounted","watch","toRef","_ref2","_ref3","_slicedToArray","id","disableIdGeneration2","newId","useId","value","removeInputId","addInputId","immediate","onUnmounted"],"sources":["../../../../../../../packages/components/form/src/hooks/use-form-item.ts"],"sourcesContent":["import {\n  computed,\n  inject,\n  onMounted,\n  onUnmounted,\n  ref,\n  toRef,\n  watch,\n} from 'vue'\nimport { useId } from '@element-plus/hooks'\nimport { formContextKey, formItemContextKey } from '../constants'\n\nimport type { ComputedRef, Ref, WatchStopHandle } from 'vue'\nimport type { FormItemContext } from '../types'\n\nexport const useFormItem = () => {\n  const form = inject(formContextKey, undefined)\n  const formItem = inject(formItemContextKey, undefined)\n  return {\n    form,\n    formItem,\n  }\n}\n\nexport type IUseFormItemInputCommonProps = {\n  id?: string\n  label?: string | number | boolean | Record<string, any>\n}\n\nexport const useFormItemInputId = (\n  props: Partial<IUseFormItemInputCommonProps>,\n  {\n    formItemContext,\n    disableIdGeneration,\n    disableIdManagement,\n  }: {\n    formItemContext?: FormItemContext\n    disableIdGeneration?: ComputedRef<boolean> | Ref<boolean>\n    disableIdManagement?: ComputedRef<boolean> | Ref<boolean>\n  }\n) => {\n  if (!disableIdGeneration) {\n    disableIdGeneration = ref<boolean>(false)\n  }\n  if (!disableIdManagement) {\n    disableIdManagement = ref<boolean>(false)\n  }\n\n  const inputId = ref<string>()\n  let idUnwatch: WatchStopHandle | undefined = undefined\n\n  const isLabeledByFormItem = computed<boolean>(() => {\n    return !!(\n      !props.label &&\n      formItemContext &&\n      formItemContext.inputIds &&\n      formItemContext.inputIds?.length <= 1\n    )\n  })\n\n  // Generate id for ElFormItem label if not provided as prop\n  onMounted(() => {\n    idUnwatch = watch(\n      [toRef(props, 'id'), disableIdGeneration] as any,\n      ([id, disableIdGeneration]: [string, boolean]) => {\n        const newId = id ?? (!disableIdGeneration ? useId().value : undefined)\n        if (newId !== inputId.value) {\n          if (formItemContext?.removeInputId) {\n            inputId.value && formItemContext.removeInputId(inputId.value)\n            if (!disableIdManagement?.value && !disableIdGeneration && newId) {\n              formItemContext.addInputId(newId)\n            }\n          }\n          inputId.value = newId\n        }\n      },\n      { immediate: true }\n    )\n  })\n\n  onUnmounted(() => {\n    idUnwatch && idUnwatch()\n    if (formItemContext?.removeInputId) {\n      inputId.value && formItemContext.removeInputId(inputId.value)\n    }\n  })\n\n  return {\n    isLabeledByFormItem,\n    inputId,\n  }\n}\n"],"mappings":";;;;;;;;;;AAWY,IAACA,WAAW,GAAG,SAAdA,WAAWA,CAAA,EAAS;EAC/B,IAAMC,IAAI,GAAGC,MAAM,CAACC,cAAc,EAAE,KAAK,CAAC,CAAC;EAC3C,IAAMC,QAAQ,GAAGF,MAAM,CAACG,kBAAkB,EAAE,KAAK,CAAC,CAAC;EACnD,OAAO;IACLJ,IAAI,EAAJA,IAAI;IACJG,QAAQ,EAARA;EACJ,CAAG;AACH;AACY,IAACE,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAIC,KAAK,EAAAC,IAAA,EAIlC;EAAA,IAHJC,eAAe,GAAAD,IAAA,CAAfC,eAAe;IACfC,mBAAmB,GAAAF,IAAA,CAAnBE,mBAAmB;IACnBC,mBAAmB,GAAAH,IAAA,CAAnBG,mBAAmB;EAEnB,IAAI,CAACD,mBAAmB,EAAE;IACxBA,mBAAmB,GAAGE,GAAG,CAAC,KAAK,CAAC;EACpC;EACE,IAAI,CAACD,mBAAmB,EAAE;IACxBA,mBAAmB,GAAGC,GAAG,CAAC,KAAK,CAAC;EACpC;EACE,IAAMC,OAAO,GAAGD,GAAG,EAAE;EACrB,IAAIE,SAAS,GAAG,KAAK,CAAC;EACtB,IAAMC,mBAAmB,GAAGC,QAAQ,CAAC,YAAM;IACzC,IAAIC,EAAE;IACN,OAAO,CAAC,EAAE,CAACV,KAAK,CAACW,KAAK,IAAIT,eAAe,IAAIA,eAAe,CAACU,QAAQ,IAAI,CAAC,CAACF,EAAE,GAAGR,eAAe,CAACU,QAAQ,KAAK,IAAI,GAAG,KAAK,CAAC,GAAGF,EAAE,CAACG,MAAM,KAAK,CAAC,CAAC;EACjJ,CAAG,CAAC;EACFC,SAAS,CAAC,YAAM;IACdP,SAAS,GAAGQ,KAAK,CAAC,CAACC,KAAK,CAAChB,KAAK,EAAE,IAAI,CAAC,EAAEG,mBAAmB,CAAC,EAAE,UAAAc,KAAA,EAAgC;MAAA,IAAAC,KAAA,GAAAC,cAAA,CAAAF,KAAA;QAA9BG,EAAE,GAAAF,KAAA;QAAEG,oBAAoB,GAAAH,KAAA;MACrF,IAAMI,KAAK,GAAGF,EAAE,IAAI,IAAI,GAAGA,EAAE,GAAG,CAACC,oBAAoB,GAAGE,KAAK,EAAE,CAACC,KAAK,GAAG,KAAK,CAAC;MAC9E,IAAIF,KAAK,KAAKhB,OAAO,CAACkB,KAAK,EAAE;QAC3B,IAAItB,eAAe,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,eAAe,CAACuB,aAAa,EAAE;UACpEnB,OAAO,CAACkB,KAAK,IAAItB,eAAe,CAACuB,aAAa,CAACnB,OAAO,CAACkB,KAAK,CAAC;UAC7D,IAAI,EAAEpB,mBAAmB,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,mBAAmB,CAACoB,KAAK,CAAC,IAAI,CAACH,oBAAoB,IAAIC,KAAK,EAAE;YACzGpB,eAAe,CAACwB,UAAU,CAACJ,KAAK,CAAC;UAC7C;QACA;QACQhB,OAAO,CAACkB,KAAK,GAAGF,KAAK;MAC7B;IACA,CAAK,EAAE;MAAEK,SAAS,EAAE;IAAI,CAAE,CAAC;EAC3B,CAAG,CAAC;EACFC,WAAW,CAAC,YAAM;IAChBrB,SAAS,IAAIA,SAAS,EAAE;IACxB,IAAIL,eAAe,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,eAAe,CAACuB,aAAa,EAAE;MACpEnB,OAAO,CAACkB,KAAK,IAAItB,eAAe,CAACuB,aAAa,CAACnB,OAAO,CAACkB,KAAK,CAAC;IACnE;EACA,CAAG,CAAC;EACF,OAAO;IACLhB,mBAAmB,EAAnBA,mBAAmB;IACnBF,OAAO,EAAPA;EACJ,CAAG;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}