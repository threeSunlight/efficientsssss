{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { defineComponent, inject, ref, computed, markRaw, watch, openBlock, createElementBlock, unref, normalizeClass, normalizeStyle, Fragment, renderList, createVNode, withCtx, withDirectives, createBlock, resolveDynamicComponent, vShow, createCommentVNode, toDisplayString } from 'vue';\nimport '../../../constants/index.mjs';\nimport '../../../utils/index.mjs';\nimport '../../form/index.mjs';\nimport { ElIcon } from '../../icon/index.mjs';\nimport '../../../hooks/index.mjs';\nimport { rateProps, rateEmits } from './rate.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { isObject, isArray, isString } from '@vue/shared';\nimport { formContextKey, formItemContextKey } from '../../form/src/constants.mjs';\nimport { useFormSize } from '../../form/src/hooks/use-form-common-props.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useFormItemInputId } from '../../form/src/hooks/use-form-item.mjs';\nimport { UPDATE_MODEL_EVENT } from '../../../constants/event.mjs';\nimport { EVENT_CODE } from '../../../constants/aria.mjs';\nimport { hasClass } from '../../../utils/dom/style.mjs';\nvar _hoisted_1 = [\"id\", \"aria-label\", \"aria-labelledby\", \"aria-valuenow\", \"aria-valuetext\", \"aria-valuemax\"];\nvar _hoisted_2 = [\"onMousemove\", \"onClick\"];\nvar __default__ = defineComponent({\n  name: \"ElRate\"\n});\nvar _sfc_main = /* @__PURE__ */defineComponent(_objectSpread(_objectSpread({}, __default__), {}, {\n  props: rateProps,\n  emits: rateEmits,\n  setup: function setup(__props, _ref) {\n    var expose = _ref.expose,\n      emit = _ref.emit;\n    var props = __props;\n    function getValueFromMap(value, map) {\n      var isExcludedObject = function isExcludedObject(val) {\n        return isObject(val);\n      };\n      var matchedKeys = Object.keys(map).map(function (key) {\n        return +key;\n      }).filter(function (key) {\n        var val = map[key];\n        var excluded = isExcludedObject(val) ? val.excluded : false;\n        return excluded ? value < key : value <= key;\n      }).sort(function (a, b) {\n        return a - b;\n      });\n      var matchedValue = map[matchedKeys[0]];\n      return isExcludedObject(matchedValue) && matchedValue.value || matchedValue;\n    }\n    var formContext = inject(formContextKey, void 0);\n    var formItemContext = inject(formItemContextKey, void 0);\n    var rateSize = useFormSize();\n    var ns = useNamespace(\"rate\");\n    var _useFormItemInputId = useFormItemInputId(props, {\n        formItemContext: formItemContext\n      }),\n      inputId = _useFormItemInputId.inputId,\n      isLabeledByFormItem = _useFormItemInputId.isLabeledByFormItem;\n    var currentValue = ref(props.modelValue);\n    var hoverIndex = ref(-1);\n    var pointerAtLeftHalf = ref(true);\n    var rateClasses = computed(function () {\n      return [ns.b(), ns.m(rateSize.value)];\n    });\n    var rateDisabled = computed(function () {\n      return props.disabled || (formContext == null ? void 0 : formContext.disabled);\n    });\n    var rateStyles = computed(function () {\n      return ns.cssVarBlock({\n        \"void-color\": props.voidColor,\n        \"disabled-void-color\": props.disabledVoidColor,\n        \"fill-color\": activeColor.value\n      });\n    });\n    var text = computed(function () {\n      var result = \"\";\n      if (props.showScore) {\n        result = props.scoreTemplate.replace(/\\{\\s*value\\s*\\}/, rateDisabled.value ? \"\".concat(props.modelValue) : \"\".concat(currentValue.value));\n      } else if (props.showText) {\n        result = props.texts[Math.ceil(currentValue.value) - 1];\n      }\n      return result;\n    });\n    var valueDecimal = computed(function () {\n      return props.modelValue * 100 - Math.floor(props.modelValue) * 100;\n    });\n    var colorMap = computed(function () {\n      var _ref2;\n      return isArray(props.colors) ? (_ref2 = {}, _defineProperty(_ref2, props.lowThreshold, props.colors[0]), _defineProperty(_ref2, props.highThreshold, {\n        value: props.colors[1],\n        excluded: true\n      }), _defineProperty(_ref2, props.max, props.colors[2]), _ref2) : props.colors;\n    });\n    var activeColor = computed(function () {\n      var color = getValueFromMap(currentValue.value, colorMap.value);\n      return isObject(color) ? \"\" : color;\n    });\n    var decimalStyle = computed(function () {\n      var width = \"\";\n      if (rateDisabled.value) {\n        width = \"\".concat(valueDecimal.value, \"%\");\n      } else if (props.allowHalf) {\n        width = \"50%\";\n      }\n      return {\n        color: activeColor.value,\n        width: width\n      };\n    });\n    var componentMap = computed(function () {\n      var _ref3;\n      var icons = isArray(props.icons) ? _toConsumableArray(props.icons) : _objectSpread({}, props.icons);\n      icons = markRaw(icons);\n      return isArray(icons) ? (_ref3 = {}, _defineProperty(_ref3, props.lowThreshold, icons[0]), _defineProperty(_ref3, props.highThreshold, {\n        value: icons[1],\n        excluded: true\n      }), _defineProperty(_ref3, props.max, icons[2]), _ref3) : icons;\n    });\n    var decimalIconComponent = computed(function () {\n      return getValueFromMap(props.modelValue, componentMap.value);\n    });\n    var voidComponent = computed(function () {\n      return rateDisabled.value ? isString(props.disabledVoidIcon) ? props.disabledVoidIcon : markRaw(props.disabledVoidIcon) : isString(props.voidIcon) ? props.voidIcon : markRaw(props.voidIcon);\n    });\n    var activeComponent = computed(function () {\n      return getValueFromMap(currentValue.value, componentMap.value);\n    });\n    function showDecimalIcon(item) {\n      var showWhenDisabled = rateDisabled.value && valueDecimal.value > 0 && item - 1 < props.modelValue && item > props.modelValue;\n      var showWhenAllowHalf = props.allowHalf && pointerAtLeftHalf.value && item - 0.5 <= currentValue.value && item > currentValue.value;\n      return showWhenDisabled || showWhenAllowHalf;\n    }\n    function emitValue(value) {\n      if (props.clearable && value === props.modelValue) {\n        value = 0;\n      }\n      emit(UPDATE_MODEL_EVENT, value);\n      if (props.modelValue !== value) {\n        emit(\"change\", value);\n      }\n    }\n    function selectValue(value) {\n      if (rateDisabled.value) {\n        return;\n      }\n      if (props.allowHalf && pointerAtLeftHalf.value) {\n        emitValue(currentValue.value);\n      } else {\n        emitValue(value);\n      }\n    }\n    function handleKey(e) {\n      if (rateDisabled.value) {\n        return;\n      }\n      var _currentValue = currentValue.value;\n      var code = e.code;\n      if (code === EVENT_CODE.up || code === EVENT_CODE.right) {\n        if (props.allowHalf) {\n          _currentValue += 0.5;\n        } else {\n          _currentValue += 1;\n        }\n        e.stopPropagation();\n        e.preventDefault();\n      } else if (code === EVENT_CODE.left || code === EVENT_CODE.down) {\n        if (props.allowHalf) {\n          _currentValue -= 0.5;\n        } else {\n          _currentValue -= 1;\n        }\n        e.stopPropagation();\n        e.preventDefault();\n      }\n      _currentValue = _currentValue < 0 ? 0 : _currentValue;\n      _currentValue = _currentValue > props.max ? props.max : _currentValue;\n      emit(UPDATE_MODEL_EVENT, _currentValue);\n      emit(\"change\", _currentValue);\n      return _currentValue;\n    }\n    function setCurrentValue(value, event) {\n      if (rateDisabled.value) {\n        return;\n      }\n      if (props.allowHalf && event) {\n        var target = event.target;\n        if (hasClass(target, ns.e(\"item\"))) {\n          target = target.querySelector(\".\".concat(ns.e(\"icon\")));\n        }\n        if (target.clientWidth === 0 || hasClass(target, ns.e(\"decimal\"))) {\n          target = target.parentNode;\n        }\n        pointerAtLeftHalf.value = event.offsetX * 2 <= target.clientWidth;\n        currentValue.value = pointerAtLeftHalf.value ? value - 0.5 : value;\n      } else {\n        currentValue.value = value;\n      }\n      hoverIndex.value = value;\n    }\n    function resetCurrentValue() {\n      if (rateDisabled.value) {\n        return;\n      }\n      if (props.allowHalf) {\n        pointerAtLeftHalf.value = props.modelValue !== Math.floor(props.modelValue);\n      }\n      currentValue.value = props.modelValue;\n      hoverIndex.value = -1;\n    }\n    watch(function () {\n      return props.modelValue;\n    }, function (val) {\n      currentValue.value = val;\n      pointerAtLeftHalf.value = props.modelValue !== Math.floor(props.modelValue);\n    });\n    if (!props.modelValue) {\n      emit(UPDATE_MODEL_EVENT, 0);\n    }\n    expose({\n      setCurrentValue: setCurrentValue,\n      resetCurrentValue: resetCurrentValue\n    });\n    return function (_ctx, _cache) {\n      var _a;\n      return openBlock(), createElementBlock(\"div\", {\n        id: unref(inputId),\n        \"class\": normalizeClass([unref(rateClasses), unref(ns).is(\"disabled\", unref(rateDisabled))]),\n        role: \"slider\",\n        \"aria-label\": !unref(isLabeledByFormItem) ? _ctx.label || \"rating\" : void 0,\n        \"aria-labelledby\": unref(isLabeledByFormItem) ? (_a = unref(formItemContext)) == null ? void 0 : _a.labelId : void 0,\n        \"aria-valuenow\": currentValue.value,\n        \"aria-valuetext\": unref(text) || void 0,\n        \"aria-valuemin\": \"0\",\n        \"aria-valuemax\": _ctx.max,\n        tabindex: \"0\",\n        style: normalizeStyle(unref(rateStyles)),\n        onKeydown: handleKey\n      }, [(openBlock(true), createElementBlock(Fragment, null, renderList(_ctx.max, function (item, key) {\n        return openBlock(), createElementBlock(\"span\", {\n          key: key,\n          \"class\": normalizeClass(unref(ns).e(\"item\")),\n          onMousemove: function onMousemove($event) {\n            return setCurrentValue(item, $event);\n          },\n          onMouseleave: resetCurrentValue,\n          onClick: function onClick($event) {\n            return selectValue(item);\n          }\n        }, [createVNode(unref(ElIcon), {\n          \"class\": normalizeClass([unref(ns).e(\"icon\"), {\n            hover: hoverIndex.value === item\n          }, unref(ns).is(\"active\", item <= currentValue.value)])\n        }, {\n          \"default\": withCtx(function () {\n            return [!showDecimalIcon(item) ? (openBlock(), createElementBlock(Fragment, {\n              key: 0\n            }, [withDirectives((openBlock(), createBlock(resolveDynamicComponent(unref(activeComponent)), null, null, 512)), [[vShow, item <= currentValue.value]]), withDirectives((openBlock(), createBlock(resolveDynamicComponent(unref(voidComponent)), null, null, 512)), [[vShow, !(item <= currentValue.value)]])], 64)) : createCommentVNode(\"v-if\", true), showDecimalIcon(item) ? (openBlock(), createBlock(unref(ElIcon), {\n              key: 1,\n              style: normalizeStyle(unref(decimalStyle)),\n              \"class\": normalizeClass([unref(ns).e(\"icon\"), unref(ns).e(\"decimal\")])\n            }, {\n              \"default\": withCtx(function () {\n                return [(openBlock(), createBlock(resolveDynamicComponent(unref(decimalIconComponent))))];\n              }),\n              _: 1\n            }, 8, [\"style\", \"class\"])) : createCommentVNode(\"v-if\", true)];\n          }),\n          _: 2\n        }, 1032, [\"class\"])], 42, _hoisted_2);\n      }), 128)), _ctx.showText || _ctx.showScore ? (openBlock(), createElementBlock(\"span\", {\n        key: 0,\n        \"class\": normalizeClass(unref(ns).e(\"text\"))\n      }, toDisplayString(unref(text)), 3)) : createCommentVNode(\"v-if\", true)], 46, _hoisted_1);\n    };\n  }\n}));\nvar Rate = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/rate/src/rate.vue\"]]);\nexport { Rate as default };","map":{"version":3,"names":["name","getValueFromMap","value","map","isExcludedObject","val","isObject","matchedKeys","Object","keys","key","filter","excluded","sort","a","b","matchedValue","formContext","inject","formContextKey","formItemContext","formItemContextKey","rateSize","useFormSize","ns","useNamespace","_useFormItemInputId","useFormItemInputId","props","inputId","isLabeledByFormItem","currentValue","ref","modelValue","hoverIndex","pointerAtLeftHalf","rateClasses","computed","m","rateDisabled","disabled","rateStyles","cssVarBlock","voidColor","disabledVoidColor","activeColor","text","result","showScore","scoreTemplate","replace","concat","showText","texts","Math","ceil","valueDecimal","floor","colorMap","_ref2","isArray","colors","_defineProperty","lowThreshold","highThreshold","max","color","decimalStyle","width","allowHalf","componentMap","_ref3","icons","_toConsumableArray","_objectSpread","markRaw","decimalIconComponent","voidComponent","isString","disabledVoidIcon","voidIcon","activeComponent","showDecimalIcon","item","showWhenDisabled","showWhenAllowHalf","emitValue","clearable","emit","UPDATE_MODEL_EVENT","selectValue","handleKey","e","_currentValue","code","EVENT_CODE","up","right","stopPropagation","preventDefault","left","down","setCurrentValue","event","target","hasClass","querySelector","clientWidth","parentNode","offsetX","resetCurrentValue","watch","expose"],"sources":["../../../../../../packages/components/rate/src/rate.vue"],"sourcesContent":["<template>\n  <div\n    :id=\"inputId\"\n    :class=\"[rateClasses, ns.is('disabled', rateDisabled)]\"\n    role=\"slider\"\n    :aria-label=\"!isLabeledByFormItem ? label || 'rating' : undefined\"\n    :aria-labelledby=\"\n      isLabeledByFormItem ? formItemContext?.labelId : undefined\n    \"\n    :aria-valuenow=\"currentValue\"\n    :aria-valuetext=\"text || undefined\"\n    aria-valuemin=\"0\"\n    :aria-valuemax=\"max\"\n    tabindex=\"0\"\n    :style=\"rateStyles\"\n    @keydown=\"handleKey\"\n  >\n    <span\n      v-for=\"(item, key) in max\"\n      :key=\"key\"\n      :class=\"ns.e('item')\"\n      @mousemove=\"setCurrentValue(item, $event)\"\n      @mouseleave=\"resetCurrentValue\"\n      @click=\"selectValue(item)\"\n    >\n      <el-icon\n        :class=\"[\n          ns.e('icon'),\n          { hover: hoverIndex === item },\n          ns.is('active', item <= currentValue),\n        ]\"\n      >\n        <template v-if=\"!showDecimalIcon(item)\">\n          <component :is=\"activeComponent\" v-show=\"item <= currentValue\" />\n          <component :is=\"voidComponent\" v-show=\"!(item <= currentValue)\" />\n        </template>\n        <el-icon\n          v-if=\"showDecimalIcon(item)\"\n          :style=\"decimalStyle\"\n          :class=\"[ns.e('icon'), ns.e('decimal')]\"\n        >\n          <component :is=\"decimalIconComponent\" />\n        </el-icon>\n      </el-icon>\n    </span>\n    <span v-if=\"showText || showScore\" :class=\"ns.e('text')\">\n      {{ text }}\n    </span>\n  </div>\n</template>\n<script lang=\"ts\" setup>\nimport { computed, inject, markRaw, ref, watch } from 'vue'\nimport { EVENT_CODE, UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport { hasClass, isArray, isObject, isString } from '@element-plus/utils'\nimport {\n  formContextKey,\n  formItemContextKey,\n  useFormItemInputId,\n  useFormSize,\n} from '@element-plus/components/form'\nimport { ElIcon } from '@element-plus/components/icon'\nimport { useNamespace } from '@element-plus/hooks'\nimport { rateEmits, rateProps } from './rate'\nimport type { iconPropType } from '@element-plus/utils'\nimport type { CSSProperties, Component } from 'vue'\n\nfunction getValueFromMap<T>(\n  value: number,\n  map: Record<string, T | { excluded?: boolean; value: T }>\n) {\n  const isExcludedObject = (\n    val: unknown\n  ): val is { excluded?: boolean } & Record<any, unknown> => isObject(val)\n\n  const matchedKeys = Object.keys(map)\n    .map((key) => +key)\n    .filter((key) => {\n      const val = map[key]\n      const excluded = isExcludedObject(val) ? val.excluded : false\n      return excluded ? value < key : value <= key\n    })\n    .sort((a, b) => a - b)\n  const matchedValue = map[matchedKeys[0]]\n  return (isExcludedObject(matchedValue) && matchedValue.value) || matchedValue\n}\n\ndefineOptions({\n  name: 'ElRate',\n})\n\nconst props = defineProps(rateProps)\nconst emit = defineEmits(rateEmits)\n\nconst formContext = inject(formContextKey, undefined)\nconst formItemContext = inject(formItemContextKey, undefined)\nconst rateSize = useFormSize()\nconst ns = useNamespace('rate')\nconst { inputId, isLabeledByFormItem } = useFormItemInputId(props, {\n  formItemContext,\n})\n\nconst currentValue = ref(props.modelValue)\nconst hoverIndex = ref(-1)\nconst pointerAtLeftHalf = ref(true)\n\nconst rateClasses = computed(() => [ns.b(), ns.m(rateSize.value)])\nconst rateDisabled = computed(() => props.disabled || formContext?.disabled)\nconst rateStyles = computed(() => {\n  return ns.cssVarBlock({\n    'void-color': props.voidColor,\n    'disabled-void-color': props.disabledVoidColor,\n    'fill-color': activeColor.value,\n  }) as CSSProperties\n})\n\nconst text = computed(() => {\n  let result = ''\n  if (props.showScore) {\n    result = props.scoreTemplate.replace(\n      /\\{\\s*value\\s*\\}/,\n      rateDisabled.value ? `${props.modelValue}` : `${currentValue.value}`\n    )\n  } else if (props.showText) {\n    result = props.texts[Math.ceil(currentValue.value) - 1]\n  }\n  return result\n})\nconst valueDecimal = computed(\n  () => props.modelValue * 100 - Math.floor(props.modelValue) * 100\n)\nconst colorMap = computed(() =>\n  isArray(props.colors)\n    ? {\n        [props.lowThreshold]: props.colors[0],\n        [props.highThreshold]: { value: props.colors[1], excluded: true },\n        [props.max]: props.colors[2],\n      }\n    : props.colors\n)\nconst activeColor = computed(() => {\n  const color = getValueFromMap(currentValue.value, colorMap.value)\n  // {value: '', excluded: true} returned\n  return isObject(color) ? '' : color\n})\nconst decimalStyle = computed(() => {\n  let width = ''\n  if (rateDisabled.value) {\n    width = `${valueDecimal.value}%`\n  } else if (props.allowHalf) {\n    width = '50%'\n  }\n  return {\n    color: activeColor.value,\n    width,\n  }\n})\nconst componentMap = computed(() => {\n  let icons = isArray(props.icons) ? [...props.icons] : { ...props.icons }\n  icons = markRaw(icons) as\n    | Array<string | Component>\n    | Record<number, string | Component>\n  return isArray(icons)\n    ? {\n        [props.lowThreshold]: icons[0],\n        [props.highThreshold]: {\n          value: icons[1],\n          excluded: true,\n        },\n        [props.max]: icons[2],\n      }\n    : icons\n})\nconst decimalIconComponent = computed(() =>\n  getValueFromMap(props.modelValue, componentMap.value)\n)\nconst voidComponent = computed(() =>\n  rateDisabled.value\n    ? isString(props.disabledVoidIcon)\n      ? props.disabledVoidIcon\n      : (markRaw(props.disabledVoidIcon) as typeof iconPropType)\n    : isString(props.voidIcon)\n    ? props.voidIcon\n    : (markRaw(props.voidIcon) as typeof iconPropType)\n)\nconst activeComponent = computed(() =>\n  getValueFromMap(currentValue.value, componentMap.value)\n)\n\nfunction showDecimalIcon(item: number) {\n  const showWhenDisabled =\n    rateDisabled.value &&\n    valueDecimal.value > 0 &&\n    item - 1 < props.modelValue &&\n    item > props.modelValue\n  const showWhenAllowHalf =\n    props.allowHalf &&\n    pointerAtLeftHalf.value &&\n    item - 0.5 <= currentValue.value &&\n    item > currentValue.value\n  return showWhenDisabled || showWhenAllowHalf\n}\n\nfunction emitValue(value: number) {\n  // if allow clear, and selected value is same as modelValue, reset value to 0\n  if (props.clearable && value === props.modelValue) {\n    value = 0\n  }\n\n  emit(UPDATE_MODEL_EVENT, value)\n  if (props.modelValue !== value) {\n    emit('change', value)\n  }\n}\n\nfunction selectValue(value: number) {\n  if (rateDisabled.value) {\n    return\n  }\n  if (props.allowHalf && pointerAtLeftHalf.value) {\n    emitValue(currentValue.value)\n  } else {\n    emitValue(value)\n  }\n}\n\nfunction handleKey(e: KeyboardEvent) {\n  if (rateDisabled.value) {\n    return\n  }\n  let _currentValue = currentValue.value\n  const code = e.code\n  if (code === EVENT_CODE.up || code === EVENT_CODE.right) {\n    if (props.allowHalf) {\n      _currentValue += 0.5\n    } else {\n      _currentValue += 1\n    }\n    e.stopPropagation()\n    e.preventDefault()\n  } else if (code === EVENT_CODE.left || code === EVENT_CODE.down) {\n    if (props.allowHalf) {\n      _currentValue -= 0.5\n    } else {\n      _currentValue -= 1\n    }\n    e.stopPropagation()\n    e.preventDefault()\n  }\n  _currentValue = _currentValue < 0 ? 0 : _currentValue\n  _currentValue = _currentValue > props.max ? props.max : _currentValue\n  emit(UPDATE_MODEL_EVENT, _currentValue)\n  emit('change', _currentValue)\n  return _currentValue\n}\n\nfunction setCurrentValue(value: number, event?: MouseEvent) {\n  if (rateDisabled.value) {\n    return\n  }\n  if (props.allowHalf && event) {\n    // TODO: use cache via computed https://github.com/element-plus/element-plus/pull/5456#discussion_r786472092\n    let target = event.target as HTMLElement\n    if (hasClass(target, ns.e('item'))) {\n      target = target.querySelector(`.${ns.e('icon')}`)!\n    }\n    if (target.clientWidth === 0 || hasClass(target, ns.e('decimal'))) {\n      target = target.parentNode as HTMLElement\n    }\n    pointerAtLeftHalf.value = event.offsetX * 2 <= target.clientWidth\n    currentValue.value = pointerAtLeftHalf.value ? value - 0.5 : value\n  } else {\n    currentValue.value = value\n  }\n  hoverIndex.value = value\n}\n\nfunction resetCurrentValue() {\n  if (rateDisabled.value) {\n    return\n  }\n  if (props.allowHalf) {\n    pointerAtLeftHalf.value = props.modelValue !== Math.floor(props.modelValue)\n  }\n  currentValue.value = props.modelValue\n  hoverIndex.value = -1\n}\n\nwatch(\n  () => props.modelValue,\n  (val) => {\n    currentValue.value = val\n    pointerAtLeftHalf.value = props.modelValue !== Math.floor(props.modelValue)\n  }\n)\n\nif (!props.modelValue) {\n  emit(UPDATE_MODEL_EVENT, 0)\n}\n\ndefineExpose({\n  /** @description set current value */\n  setCurrentValue,\n  /** @description reset current value */\n  resetCurrentValue,\n})\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}