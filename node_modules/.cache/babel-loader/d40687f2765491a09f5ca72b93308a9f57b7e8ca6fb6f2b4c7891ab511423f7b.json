{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { inject, ref, computed, unref, watch, onMounted } from 'vue';\nimport { isUndefined } from 'lodash-unified';\nimport '../../../../hooks/index.mjs';\nimport { POPPER_INJECTION_KEY } from '../constants.mjs';\nimport { buildPopperOptions, unwrapMeasurableEl } from '../utils.mjs';\nimport { usePopper } from '../../../../hooks/use-popper/index.mjs';\nvar DEFAULT_ARROW_OFFSET = 0;\nvar usePopperContent = function usePopperContent(props) {\n  var _inject = inject(POPPER_INJECTION_KEY, void 0),\n    popperInstanceRef = _inject.popperInstanceRef,\n    contentRef = _inject.contentRef,\n    triggerRef = _inject.triggerRef,\n    role = _inject.role;\n  var arrowRef = ref();\n  var arrowOffset = ref();\n  var eventListenerModifier = computed(function () {\n    return {\n      name: \"eventListeners\",\n      enabled: !!props.visible\n    };\n  });\n  var arrowModifier = computed(function () {\n    var _a;\n    var arrowEl = unref(arrowRef);\n    var offset = (_a = unref(arrowOffset)) != null ? _a : DEFAULT_ARROW_OFFSET;\n    return {\n      name: \"arrow\",\n      enabled: !isUndefined(arrowEl),\n      options: {\n        element: arrowEl,\n        padding: offset\n      }\n    };\n  });\n  var options = computed(function () {\n    return _objectSpread({\n      onFirstUpdate: function onFirstUpdate() {\n        update();\n      }\n    }, buildPopperOptions(props, [unref(arrowModifier), unref(eventListenerModifier)]));\n  });\n  var computedReference = computed(function () {\n    return unwrapMeasurableEl(props.referenceEl) || unref(triggerRef);\n  });\n  var _usePopper = usePopper(computedReference, contentRef, options),\n    attributes = _usePopper.attributes,\n    state = _usePopper.state,\n    styles = _usePopper.styles,\n    update = _usePopper.update,\n    forceUpdate = _usePopper.forceUpdate,\n    instanceRef = _usePopper.instanceRef;\n  watch(instanceRef, function (instance) {\n    return popperInstanceRef.value = instance;\n  });\n  onMounted(function () {\n    watch(function () {\n      var _a;\n      return (_a = unref(computedReference)) == null ? void 0 : _a.getBoundingClientRect();\n    }, function () {\n      update();\n    });\n  });\n  return {\n    attributes: attributes,\n    arrowRef: arrowRef,\n    contentRef: contentRef,\n    instanceRef: instanceRef,\n    state: state,\n    styles: styles,\n    role: role,\n    forceUpdate: forceUpdate,\n    update: update\n  };\n};\nexport { usePopperContent };","map":{"version":3,"names":["DEFAULT_ARROW_OFFSET","usePopperContent","props","_inject","inject","POPPER_INJECTION_KEY","popperInstanceRef","contentRef","triggerRef","role","arrowRef","ref","arrowOffset","eventListenerModifier","computed","name","enabled","visible","arrowModifier","_a","arrowEl","unref","offset","isUndefined","options","element","padding","_objectSpread","onFirstUpdate","update","buildPopperOptions","computedReference","unwrapMeasurableEl","referenceEl","_usePopper","usePopper","attributes","state","styles","forceUpdate","instanceRef","watch","instance","value","onMounted","getBoundingClientRect"],"sources":["../../../../../../../packages/components/popper/src/composables/use-content.ts"],"sourcesContent":["import { computed, inject, onMounted, ref, unref, watch } from 'vue'\nimport { isUndefined } from 'lodash-unified'\nimport { usePopper } from '@element-plus/hooks'\nimport { POPPER_INJECTION_KEY } from '../constants'\nimport { buildPopperOptions, unwrapMeasurableEl } from '../utils'\n\nimport type { Modifier } from '@popperjs/core'\nimport type { PartialOptions } from '@element-plus/hooks'\nimport type { PopperContentProps } from '../content'\n\nconst DEFAULT_ARROW_OFFSET = 0\n\nexport const usePopperContent = (props: PopperContentProps) => {\n  const { popperInstanceRef, contentRef, triggerRef, role } = inject(\n    POPPER_INJECTION_KEY,\n    undefined\n  )!\n\n  const arrowRef = ref<HTMLElement>()\n  const arrowOffset = ref<number>()\n\n  const eventListenerModifier = computed(() => {\n    return {\n      name: 'eventListeners',\n      enabled: !!props.visible,\n    } as Modifier<'eventListeners', any>\n  })\n\n  const arrowModifier = computed(() => {\n    const arrowEl = unref(arrowRef)\n    const offset = unref(arrowOffset) ?? DEFAULT_ARROW_OFFSET\n    // Seems like the `phase` and `fn` is required by Modifier type\n    // But on its documentation they didn't specify that.\n    // Refer to https://popper.js.org/docs/v2/modifiers/arrow/\n    return {\n      name: 'arrow',\n      enabled: !isUndefined(arrowEl),\n      options: {\n        element: arrowEl,\n        padding: offset,\n      },\n    } as any\n  })\n\n  const options = computed<PartialOptions>(() => {\n    return {\n      onFirstUpdate: () => {\n        update()\n      },\n      ...buildPopperOptions(props, [\n        unref(arrowModifier),\n        unref(eventListenerModifier),\n      ]),\n    }\n  })\n\n  const computedReference = computed(\n    () => unwrapMeasurableEl(props.referenceEl) || unref(triggerRef)\n  )\n\n  const { attributes, state, styles, update, forceUpdate, instanceRef } =\n    usePopper(computedReference, contentRef, options)\n\n  watch(instanceRef, (instance) => (popperInstanceRef.value = instance))\n\n  onMounted(() => {\n    watch(\n      () => unref(computedReference)?.getBoundingClientRect(),\n      () => {\n        update()\n      }\n    )\n  })\n\n  return {\n    attributes,\n    arrowRef,\n    contentRef,\n    instanceRef,\n    state,\n    styles,\n    role,\n\n    forceUpdate,\n    update,\n  }\n}\n\nexport type UsePopperContentReturn = ReturnType<typeof usePopperContent>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}