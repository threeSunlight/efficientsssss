{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { defineComponent, inject, ref, provide, onMounted, watch, unref, onBeforeUnmount, openBlock, createElementBlock, mergeProps, createVNode, withCtx, renderSlot } from 'vue';\nimport { NOOP } from '@vue/shared';\nimport { isNil } from 'lodash-unified';\nimport '../../focus-trap/index.mjs';\nimport '../../form/index.mjs';\nimport '../../../utils/index.mjs';\nimport { POPPER_CONTENT_INJECTION_KEY } from './constants.mjs';\nimport { popperContentProps, popperContentEmits } from './content.mjs';\nimport './composables/index.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { usePopperContentFocusTrap } from './composables/use-focus-trap.mjs';\nimport { usePopperContent } from './composables/use-content.mjs';\nimport { usePopperContentDOM } from './composables/use-content-dom.mjs';\nimport { formItemContextKey } from '../../form/src/constants.mjs';\nimport { isElement } from '../../../utils/types.mjs';\nimport ElFocusTrap from '../../focus-trap/src/focus-trap.mjs';\nvar __default__ = defineComponent({\n  name: \"ElPopperContent\"\n});\nvar _sfc_main = /* @__PURE__ */defineComponent(_objectSpread(_objectSpread({}, __default__), {}, {\n  props: popperContentProps,\n  emits: popperContentEmits,\n  setup: function setup(__props, _ref) {\n    var expose = _ref.expose,\n      emit = _ref.emit;\n    var props = __props;\n    var _usePopperContentFocu = usePopperContentFocusTrap(props, emit),\n      focusStartRef = _usePopperContentFocu.focusStartRef,\n      trapped = _usePopperContentFocu.trapped,\n      onFocusAfterReleased = _usePopperContentFocu.onFocusAfterReleased,\n      onFocusAfterTrapped = _usePopperContentFocu.onFocusAfterTrapped,\n      onFocusInTrap = _usePopperContentFocu.onFocusInTrap,\n      onFocusoutPrevented = _usePopperContentFocu.onFocusoutPrevented,\n      onReleaseRequested = _usePopperContentFocu.onReleaseRequested;\n    var _usePopperContent = usePopperContent(props),\n      attributes = _usePopperContent.attributes,\n      arrowRef = _usePopperContent.arrowRef,\n      contentRef = _usePopperContent.contentRef,\n      styles = _usePopperContent.styles,\n      instanceRef = _usePopperContent.instanceRef,\n      role = _usePopperContent.role,\n      update = _usePopperContent.update;\n    var _usePopperContentDOM = usePopperContentDOM(props, {\n        styles: styles,\n        attributes: attributes,\n        role: role\n      }),\n      ariaModal = _usePopperContentDOM.ariaModal,\n      arrowStyle = _usePopperContentDOM.arrowStyle,\n      contentAttrs = _usePopperContentDOM.contentAttrs,\n      contentClass = _usePopperContentDOM.contentClass,\n      contentStyle = _usePopperContentDOM.contentStyle,\n      updateZIndex = _usePopperContentDOM.updateZIndex;\n    var formItemContext = inject(formItemContextKey, void 0);\n    var arrowOffset = ref();\n    provide(POPPER_CONTENT_INJECTION_KEY, {\n      arrowStyle: arrowStyle,\n      arrowRef: arrowRef,\n      arrowOffset: arrowOffset\n    });\n    if (formItemContext && (formItemContext.addInputId || formItemContext.removeInputId)) {\n      provide(formItemContextKey, _objectSpread(_objectSpread({}, formItemContext), {}, {\n        addInputId: NOOP,\n        removeInputId: NOOP\n      }));\n    }\n    var triggerTargetAriaStopWatch = void 0;\n    var updatePopper = function updatePopper() {\n      var shouldUpdateZIndex = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      update();\n      shouldUpdateZIndex && updateZIndex();\n    };\n    var togglePopperAlive = function togglePopperAlive() {\n      updatePopper(false);\n      if (props.visible && props.focusOnShow) {\n        trapped.value = true;\n      } else if (props.visible === false) {\n        trapped.value = false;\n      }\n    };\n    onMounted(function () {\n      watch(function () {\n        return props.triggerTargetEl;\n      }, function (triggerTargetEl, prevTriggerTargetEl) {\n        triggerTargetAriaStopWatch == null ? void 0 : triggerTargetAriaStopWatch();\n        triggerTargetAriaStopWatch = void 0;\n        var el = unref(triggerTargetEl || contentRef.value);\n        var prevEl = unref(prevTriggerTargetEl || contentRef.value);\n        if (isElement(el)) {\n          triggerTargetAriaStopWatch = watch([role, function () {\n            return props.ariaLabel;\n          }, ariaModal, function () {\n            return props.id;\n          }], function (watches) {\n            ;\n            [\"role\", \"aria-label\", \"aria-modal\", \"id\"].forEach(function (key, idx) {\n              isNil(watches[idx]) ? el.removeAttribute(key) : el.setAttribute(key, watches[idx]);\n            });\n          }, {\n            immediate: true\n          });\n        }\n        if (prevEl !== el && isElement(prevEl)) {\n          ;\n          [\"role\", \"aria-label\", \"aria-modal\", \"id\"].forEach(function (key) {\n            prevEl.removeAttribute(key);\n          });\n        }\n      }, {\n        immediate: true\n      });\n      watch(function () {\n        return props.visible;\n      }, togglePopperAlive, {\n        immediate: true\n      });\n    });\n    onBeforeUnmount(function () {\n      triggerTargetAriaStopWatch == null ? void 0 : triggerTargetAriaStopWatch();\n      triggerTargetAriaStopWatch = void 0;\n    });\n    expose({\n      popperContentRef: contentRef,\n      popperInstanceRef: instanceRef,\n      updatePopper: updatePopper,\n      contentStyle: contentStyle\n    });\n    return function (_ctx, _cache) {\n      return openBlock(), createElementBlock(\"div\", mergeProps({\n        ref_key: \"contentRef\",\n        ref: contentRef\n      }, unref(contentAttrs), {\n        style: unref(contentStyle),\n        \"class\": unref(contentClass),\n        tabindex: \"-1\",\n        onMouseenter: _cache[0] || (_cache[0] = function (e) {\n          return _ctx.$emit(\"mouseenter\", e);\n        }),\n        onMouseleave: _cache[1] || (_cache[1] = function (e) {\n          return _ctx.$emit(\"mouseleave\", e);\n        })\n      }), [createVNode(unref(ElFocusTrap), {\n        trapped: unref(trapped),\n        \"trap-on-focus-in\": true,\n        \"focus-trap-el\": unref(contentRef),\n        \"focus-start-el\": unref(focusStartRef),\n        onFocusAfterTrapped: unref(onFocusAfterTrapped),\n        onFocusAfterReleased: unref(onFocusAfterReleased),\n        onFocusin: unref(onFocusInTrap),\n        onFocusoutPrevented: unref(onFocusoutPrevented),\n        onReleaseRequested: unref(onReleaseRequested)\n      }, {\n        \"default\": withCtx(function () {\n          return [renderSlot(_ctx.$slots, \"default\")];\n        }),\n        _: 3\n      }, 8, [\"trapped\", \"focus-trap-el\", \"focus-start-el\", \"onFocusAfterTrapped\", \"onFocusAfterReleased\", \"onFocusin\", \"onFocusoutPrevented\", \"onReleaseRequested\"])], 16);\n    };\n  }\n}));\nvar ElPopperContent = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue\"]]);\nexport { ElPopperContent as default };","map":{"version":3,"names":["name","_usePopperContentFocu","usePopperContentFocusTrap","props","emit","focusStartRef","trapped","onFocusAfterReleased","onFocusAfterTrapped","onFocusInTrap","onFocusoutPrevented","onReleaseRequested","_usePopperContent","usePopperContent","attributes","arrowRef","contentRef","styles","instanceRef","role","update","_usePopperContentDOM","usePopperContentDOM","ariaModal","arrowStyle","contentAttrs","contentClass","contentStyle","updateZIndex","formItemContext","inject","formItemContextKey","arrowOffset","ref","provide","POPPER_CONTENT_INJECTION_KEY","addInputId","removeInputId","_objectSpread","NOOP","triggerTargetAriaStopWatch","updatePopper","shouldUpdateZIndex","arguments","length","undefined","togglePopperAlive","visible","focusOnShow","value","onMounted","watch","triggerTargetEl","prevTriggerTargetEl","el","unref","prevEl","isElement","ariaLabel","id","watches","forEach","key","idx","isNil","removeAttribute","setAttribute","immediate","onBeforeUnmount","expose","popperContentRef","popperInstanceRef"],"sources":["../../../../../../packages/components/popper/src/content.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"contentRef\"\n    v-bind=\"contentAttrs\"\n    :style=\"contentStyle\"\n    :class=\"contentClass\"\n    tabindex=\"-1\"\n    @mouseenter=\"(e) => $emit('mouseenter', e)\"\n    @mouseleave=\"(e) => $emit('mouseleave', e)\"\n  >\n    <el-focus-trap\n      :trapped=\"trapped\"\n      :trap-on-focus-in=\"true\"\n      :focus-trap-el=\"contentRef\"\n      :focus-start-el=\"focusStartRef\"\n      @focus-after-trapped=\"onFocusAfterTrapped\"\n      @focus-after-released=\"onFocusAfterReleased\"\n      @focusin=\"onFocusInTrap\"\n      @focusout-prevented=\"onFocusoutPrevented\"\n      @release-requested=\"onReleaseRequested\"\n    >\n      <slot />\n    </el-focus-trap>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport {\n  inject,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  ref,\n  unref,\n  watch,\n} from 'vue'\nimport { NOOP } from '@vue/shared'\nimport { isNil } from 'lodash-unified'\nimport ElFocusTrap from '@element-plus/components/focus-trap'\nimport { formItemContextKey } from '@element-plus/components/form'\nimport { isElement } from '@element-plus/utils'\nimport { POPPER_CONTENT_INJECTION_KEY } from './constants'\nimport { popperContentEmits, popperContentProps } from './content'\nimport {\n  usePopperContent,\n  usePopperContentDOM,\n  usePopperContentFocusTrap,\n} from './composables'\n\nimport type { WatchStopHandle } from 'vue'\n\ndefineOptions({\n  name: 'ElPopperContent',\n})\n\nconst emit = defineEmits(popperContentEmits)\n\nconst props = defineProps(popperContentProps)\n\nconst {\n  focusStartRef,\n  trapped,\n\n  onFocusAfterReleased,\n  onFocusAfterTrapped,\n  onFocusInTrap,\n  onFocusoutPrevented,\n  onReleaseRequested,\n} = usePopperContentFocusTrap(props, emit)\n\nconst { attributes, arrowRef, contentRef, styles, instanceRef, role, update } =\n  usePopperContent(props)\n\nconst {\n  ariaModal,\n  arrowStyle,\n  contentAttrs,\n  contentClass,\n  contentStyle,\n  updateZIndex,\n} = usePopperContentDOM(props, {\n  styles,\n  attributes,\n  role,\n})\n\nconst formItemContext = inject(formItemContextKey, undefined)\nconst arrowOffset = ref<number>()\n\nprovide(POPPER_CONTENT_INJECTION_KEY, {\n  arrowStyle,\n  arrowRef,\n  arrowOffset,\n})\n\nif (\n  formItemContext &&\n  (formItemContext.addInputId || formItemContext.removeInputId)\n) {\n  // disallow auto-id from inside popper content\n  provide(formItemContextKey, {\n    ...formItemContext,\n    addInputId: NOOP,\n    removeInputId: NOOP,\n  })\n}\n\nlet triggerTargetAriaStopWatch: WatchStopHandle | undefined = undefined\n\nconst updatePopper = (shouldUpdateZIndex = true) => {\n  update()\n  shouldUpdateZIndex && updateZIndex()\n}\n\nconst togglePopperAlive = () => {\n  updatePopper(false)\n  if (props.visible && props.focusOnShow) {\n    trapped.value = true\n  } else if (props.visible === false) {\n    trapped.value = false\n  }\n}\n\nonMounted(() => {\n  watch(\n    () => props.triggerTargetEl,\n    (triggerTargetEl, prevTriggerTargetEl) => {\n      triggerTargetAriaStopWatch?.()\n      triggerTargetAriaStopWatch = undefined\n\n      const el = unref(triggerTargetEl || contentRef.value)\n      const prevEl = unref(prevTriggerTargetEl || contentRef.value)\n\n      if (isElement(el)) {\n        triggerTargetAriaStopWatch = watch(\n          [role, () => props.ariaLabel, ariaModal, () => props.id],\n          (watches) => {\n            ;['role', 'aria-label', 'aria-modal', 'id'].forEach((key, idx) => {\n              isNil(watches[idx])\n                ? el.removeAttribute(key)\n                : el.setAttribute(key, watches[idx]!)\n            })\n          },\n          { immediate: true }\n        )\n      }\n      if (prevEl !== el && isElement(prevEl)) {\n        ;['role', 'aria-label', 'aria-modal', 'id'].forEach((key) => {\n          prevEl.removeAttribute(key)\n        })\n      }\n    },\n    { immediate: true }\n  )\n\n  watch(() => props.visible, togglePopperAlive, { immediate: true })\n})\n\nonBeforeUnmount(() => {\n  triggerTargetAriaStopWatch?.()\n  triggerTargetAriaStopWatch = undefined\n})\n\ndefineExpose({\n  /**\n   * @description popper content element\n   */\n  popperContentRef: contentRef,\n  /**\n   * @description popperjs instance\n   */\n  popperInstanceRef: instanceRef,\n  /**\n   * @description method for updating popper\n   */\n  updatePopper,\n\n  /**\n   * @description content style\n   */\n  contentStyle,\n})\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}